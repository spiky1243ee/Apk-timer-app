<!DOCTYPE html>
<html>
<head>
  <title>Android APK Builder</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; padding: 40px; }
    input[type="file"] { margin: 20px; }
    button { padding: 10px 20px; background: #4CAF50; color: white; border: none; cursor: pointer; }
    button:disabled { background: gray; }
    #status { margin-top: 20px; }
  </style>
</head>
<body>
  <h1>Android APK Builder</h1>
  <p>Upload your Android Studio project ZIP and get a compiled APK.</p>
  <input type="file" id="zipFile" accept=".zip">
  <br>
  <button id="buildBtn">Build APK</button>
  <div id="status"></div>
  <script>
    document.getElementById('buildBtn').addEventListener('click', async () => {
      const fileInput = document.getElementById('zipFile');
      if (!fileInput.files.length) {
        alert('Please choose a ZIP file.');
        return;
      }
      const file = fileInput.files[0];
      const formData = new FormData();
      formData.append('zipfile', file);
      document.getElementById('status').innerText = 'Uploading and building... this may take 1â€“3 minutes.';
      document.getElementById('buildBtn').disabled = true;
      const res = await fetch('/upload', { method: 'POST', body: formData });
      if (!res.ok) {
        document.getElementById('status').innerText = 'Error: ' + (await res.text());
        document.getElementById('buildBtn').disabled = false;
        return;
      }
      const blob = await res.blob();
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'app-debug.apk';
      a.click();
      document.getElementById('status').innerText = 'Build complete! APK downloaded.';
      document.getElementById('buildBtn').disabled = false;
    });
  </script>
</body>
</html>
